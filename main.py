from modules.sql_injection import check_sql_injection
from modules.xss import check_xss
from modules.directory_listing import check_directory_listing
from modules.insecure_headers import check_insecure_headers
from modules.open_ports import check_open_ports
from modules.csrf import check_csrf
from modules.logging import log_vulnerability
from modules.reporting import generate_report

def main():
    urls = ["https://blondon1.github.io/"]
    vulnerabilities = []
    for url in urls:
        print(f"Scanning {url}")
        sql_vulns = check_sql_injection(url)
        xss_vulns = check_xss(url)
        dir_vulns = check_directory_listing(url)
        hdr_vulns = check_insecure_headers(url)
        csrf_vulns = check_csrf(url)

        all_vulns = sql_vulns + xss_vulns + dir_vulns + hdr_vulns + csrf_vulns
        vulnerabilities.extend(all_vulns)

        for vuln in all_vulns:
            log_vulnerability(vuln.split(" ")[1], url, vuln)

    generate_report(vulnerabilities)

if __name__ == "__main__":
    main()

