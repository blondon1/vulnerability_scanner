
import requests
from modules.sql_injection import check_sql_injection
from modules.xss import check_xss
from modules.directory_listing import check_directory_listing
from modules.insecure_headers import check_insecure_headers
from modules.open_ports import check_open_ports
from modules.reporting import generate_report

def main():
    urls = ["http://example.com", "http://testsite.com"]
    vulnerabilities = []
    for url in urls:
        print(f"Scanning {url}")
        vulnerabilities.extend(check_sql_injection(url))
        vulnerabilities.extend(check_xss(url))
        vulnerabilities.extend(check_directory_listing(url))
        vulnerabilities.extend(check_insecure_headers(url))
        # Assuming the IP address for open ports check
        vulnerabilities.extend(check_open_ports("127.0.0.1"))
    generate_report(vulnerabilities)

if __name__ == "__main__":
    main()
